<!DOCTYPE html>
<html lang="en">
<head>
        
        <title>Qing's Blogs</title>
        <meta charset="utf-8" />
		<meta name="description" content="YuQing Zhang's blog">
		<meta name="keywords" content="YuQing Zhang, Yuqing Zhang, Qing Zhang, Qing, Windows Azure, .NET, Python, Open Source">
		<meta name="author" content="YuQing Zhang">
		<!-- Le styles -->
		<link rel="shortcut icon" href="../static/imgs/favicon.ico">
    
		<link href="theme/css/pygment.css" rel="stylesheet">
		<link href="../static/css/bootstraper/bootstrap.css" rel="stylesheet">
		<link href="../static/css/base.css" rel="stylesheet">
		<style type="text/css">
		  body {
			padding-top: 60px;
			padding-bottom: 40px;
		  }
    </style>
    <link href="../static/css/bootstraper/bootstrap-responsive.css" rel="stylesheet">
        
</head>

<body>
    <div class="navbar navbar-fixed-top" id="top-fixed">

	        <p class="path">
	          <a href="../home.html" class="pic-link"><img class="pic-next-text-one-level" src="../static/imgs/icons/metroicons/back.png" alt /></a>
	          /<a href="../home.html">Home</a>/<a href="index.html">My blogs</a>
	        </p>
   
    </div>
	<div class="container">
        

<section id="main" class="post-body">  
<div class="row-fluid">      
<div class="span8">   
        <header> <h1 class="entry-title">Lessons Learned from VSTO2010 Development</h1> </header>
        <footer class="post-info">
                <abbr class="published" title="2012-08-24T00:00:00">
                        fr 24 august 2012
                </abbr>
        </footer><!-- /.post-info -->
        <div class="entry-content">
        <p>In the last few months, I have been involving in a project which uses Excel Add-in (VSTO 2010) as the user interface.</p>
<p>Basically, there is no vast difference between VSTO development and WinForm development. However, there were some tricks/tips that I learned.</p>
<div class="section" id="deployment">
<h2>Deployment</h2>
<p>I deployed the project using Windows Installer, which followed this article:
<a class="reference external" href="http://msdn.microsoft.com/en-us/library/ff937654.aspx">http://msdn.microsoft.com/en-us/library/ff937654.aspx</a></p>
</div>
<div class="section" id="app-config">
<h2>App.config</h2>
<p>Not like WinForm, all the VSTO2010 Add-in uses the app.config which comes with Microsoft Office. Take my project for instance, I created an app.config for the Excel Add-in and it worked perfectly in the development environment. But it failed to read that app.config after it was installed by the .msi package.</p>
<p>To fix this, right click the installer project, choose View-&gt;Registry. Under the User/Machine Hive, find the Manifest of your application and add <a class="reference external" href="file:///">file:///</a> to the value.</p>
<p>The incorrect form: [TARGETDIR]Addin.vsto|vstolocal .</p>
<p>The correct form: <a class="reference external" href="file:///">file:///</a> [TARGETDIR]Addin.vsto|vstolocal</p>
</div>
<div class="section" id="installation">
<h2>Installation</h2>
<p>Typically, user needs to install .NET 4 Client Profile and VSTO Runtime before installing the Add-in.</p>
<p>But I received several installation failure feedbacks from our customers. They are all using Office 2007 sp2 and it turns out that if you are using that version of Office, besides the two standard perquisites, an additional hotfix is also needed.  <a class="reference external" href="http://support.microsoft.com/kb/976477/">http://support.microsoft.com/kb/976477/</a></p>
</div>

        </div><!-- /.entry-content -->
        
        <div class="comments">
        <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
               var disqus_identifier = "lessons-learned-from-vsto2010-development.html";
               (function() {
               var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
               dsq.src = 'http://yuqingzhang.disqus.com/embed.js';
               (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
        </div>
        

</div>
</div>
</section>

        <footer id="contentinfo" class="body">
			<p id="foot-text"></p>
        </footer><!-- /#contentinfo -->
		<a title="Scott Hanselman is on Google+" rel="author" href="https://plus.google.com/u/0/117661881545158639820?rel=author" alt="Google+" title="Google+"></a>
		<a href="http://www.yuqingzhang.com/site/posts/index" rel="me" title="YuQing Zhang"></a>
	</div>
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="../static/scripts/bootstraper/bootstrap.min.js"></script>
	<script src="../static/scripts/base.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-32780497-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
</body>
</html>